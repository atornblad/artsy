(function(){function aa(){n&&(window.clearTimeout(n),n=null);this.removeEventListener("progress",D,!1);P(this)}function D(){n&&window.clearTimeout(n);var g=this;n=window.setTimeout(function(){n=null;g.removeEventListener("progress",D,!1);P(g)},2E3)}function P(g){for(var c=[],a=0;a<q.length;++a)q[a]!=g&&c.push(q[a]);q=c;g=document.createEvent("Event");g.initEvent("itemsLoader",!0,!0);g.total=u;g.e=u-q.length;window.dispatchEvent(g)}function ba(){A=this.currentTime}function ca(){B=!0;Q(R)}function R(g){if(E){F=
(g-S)/1E3*60;G=g-E;var c=T[H];c&&G>=c.b&&(++H,c=T[H]);if(c){var a=G-c.a,f=a/(c.b-c.a);U=da[c.c];var b=(new Date).getTime();d.globalAlpha=1;d.save();U.call(this,c.d,a,f,F);d.restore()}else B=!1;c=(22-((new Date).getTime()-b)-10*F)/200;0<c&&(c*=0.005);c=V+c;1<c?c=1:0.1>c&&(c=0.1);V=c}A&&(1>A&&(E=g-1E3*A-250),S=g);B?Q(R):(g=document.createEvent("Event"),g.initEvent("demoDone",!0,!0),window.dispatchEvent(g))}function W(g){var c=new THREE.PlaneGeometry(2E3,2E3,10,10);g=new THREE.Mesh(c,new THREE.MeshBasicMaterial({color:g}));
g.rotation.x=-0.5*Math.PI;return g}function X(g,c,d){for(var f=I(-7,8,-4,-7,8,4,-7,4,8,-7,-4,8,-7,-8,4,-7,-8,-4,-7,-4,-8,-7,4,-8,-7,0,0,7,8,-4,7,8,4,7,4,8,7,-4,8,7,-8,4,7,-8,-4,7,-4,-8,7,4,-8,7,0,0,-6,2,-1,-6,2,1,-6,1,2,-6,-1,2,-6,-2,1,-6,-2,-1,-6,-1,-2,-6,1,-2,6,2,-1,6,2,1,6,1,2,6,-1,2,6,-2,1,6,-2,-1,6,-1,-2,6,1,-2,-2,4,-2,-2,4,2,-2,2,3,-2,-2,3,-2,-4,2,-2,-4,-2,-2,-2,-3,-2,2,-3,2,4,-2,2,4,2,2,2,3,2,-2,3,2,-4,2,2,-4,-2,2,-2,-3,2,2,-3),b=new THREE.Geometry,e=0;e<f.length;++e)b.vertices.push(f[e]);
for(e=0;7>=e;++e){a(b,e,8,(e+1)%8,e%2);a(b,e+9,(e+1)%8+9,17,e%2);var f=e,k=(e+1)%8+18,h=e+18;a(b,f,(e+1)%8,k,e%2+2);a(b,k,h,f,e%2+2);var l=e+9,f=(e+1)%8+26,m=e+26;a(b,l,f,(e+1)%8+9,e%2+2);a(b,f,l,m,e%2+2);var l=e+34,n=(e+1)%8+34;a(b,h,k,n,3-e%2);a(b,n,l,h,3-e%2);k=e+42;h=(e+1)%8+42;a(b,m,h,f,3-e%2);a(b,h,m,k,3-e%2);a(b,l,n,h,e%2*4);a(b,h,k,l,e%2*4)}b.computeCentroids();b.computeFaceNormals();b.computeVertexNormals();b=new THREE.Mesh(b,new THREE.MeshFaceMaterial(J));b.position={x:g,y:c,z:d};return b}
function K(g,c,d){for(var f=I(-3,-2,-4,-1.5,0,-4,0,2,-4,1.5,0,-4,3,-2,-4,0,-2,-4,0,-2,4,0,-1,2,0,0,0,1,0,-2,0,1,-2,-1,0,-2),b=new THREE.Geometry,e=0;e<f.length;++e)b.vertices.push(f[e]);a(b,0,1,5,4);a(b,1,2,3,4);a(b,5,3,4,4);a(b,5,1,3,2);a(b,0,4,6,3);a(b,0,6,7,4);a(b,4,7,6,0);a(b,1,10,2,0);a(b,1,11,10,0);a(b,0,11,1,0);a(b,0,7,11,0);a(b,11,7,8,0);a(b,2,10,3,1);a(b,10,9,3,1);a(b,3,9,4,1);a(b,4,9,7,1);a(b,9,8,7,1);a(b,10,11,8,3);a(b,8,9,10,3);b.computeCentroids();b.computeFaceNormals();b.computeVertexNormals();
f=new THREE.Mesh(b,new THREE.MeshFaceMaterial(J));f.position={x:g,y:c,z:d};return f}function v(g,c,d){for(var f=I(-2,1,3,0,-1,4,2,1,3,2,1,-5,0,-1,-5,-2,1,-5,-2,1,1,-3,2,2,-5,-2,4,-5,-2,-5,-3,2,-3,-2,1,-2,2,1,1,3,2,2,5,-2,4,5,-2,-5,3,2,-3,2,1,-2),b=new THREE.Geometry,e=0;e<f.length;++e)b.vertices.push(f[e]);a(b,5,0,2,1);a(b,2,3,5,1);a(b,0,1,2,3);a(b,4,5,3,3);a(b,5,1,0,0);a(b,4,1,5,0);a(b,3,2,1,4);a(b,1,4,3,4);a(b,11,7,6,3);a(b,10,7,11,3);a(b,10,8,7,2);a(b,9,8,10,2);a(b,11,6,7,3);a(b,10,11,7,3);a(b,
10,7,8,2);a(b,9,10,8,2);a(b,17,12,13,2);a(b,16,17,13,2);a(b,16,13,14,3);a(b,15,16,14,3);a(b,17,13,12,2);a(b,16,13,17,2);a(b,16,14,13,3);a(b,15,14,16,3);b.computeCentroids();b.computeFaceNormals();b.computeVertexNormals();f=new THREE.Mesh(b,new THREE.MeshFaceMaterial(J));f.position={x:g,y:c,z:d};return f}function a(g,c,a,d,b){g.faces.push(new THREE.Face3(c,a,d,null,null,b))}function I(g){for(var c=[],a=0;a<arguments.length;a+=3)c.push(new THREE.Vector3(arguments[a],arguments[a+1],arguments[a+2]));
return c}function w(g){var a="#"+g.toString(16);if(L[a])return L[a];g=new THREE.MeshBasicMaterial({color:g});return L[a]=g}var G=0,F=1,Q=function(g,a,d){for(var f=0;f<g.length;++f){var b=g[f];if(a[b])return a[b]}return d}(["requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame"],window,function(a){var c=(new Date).getTime(),c=c-c%17+17-c;5>c&&(c=17);window.setTimeout(function(){a.call(window,(new Date).getTime())},c)}),Y=4*Math.atan(1);Math.max(320,256);var M,d,V,S,E,A,H=
0,U,B,Z,k,N,$,m,x,l,L=[],J=[w(11823665),w(13797955),w(11307910),w(9005668),w(9389598)],r,h,y,O,ea='ARTSY (and slightly insane);;;;;;;Pure JavaScript!;;Chrome, Safari, FireFox, iOS Safari, IE9+;(yes, even IE);;No Flash or Silverlight needed!;;;;;;;Code:;;       LBRTW;;Original design:;;       Mr. Pet;       Chaos;       McDeal;;Graphics:;;       Ra;;Music:;;       Moby;;;;;;;Thanks must go to:;;mrdoob (and all the others who contribute to Three.js), everyone I knew back in the old Demo Scene days, Google (for making a kick-ass browser);;;;;;;Some words about the demo:;;The name "Artsy (and slightly Insane)" is of course a tribute to the names of the original demo and the amazing group who made it.;;The very first scene I wrote was the "disc tunnel" effect, and I was instantly so pleased with the results that I decided to give a full remake a serious try.;;After the first two parts were done, I showed some people what I had done, and it got really nice reception. Unfortunately I had no time at the moment to finish part three.;;So the demo was left hanging for almost six months, when I finally managed to free up some time for "pleasure coding" again. :);;;;;;;This is the only part that takes advantage of WebGL (through Three.js). All other parts are 100 % hand-coded JavaScript.;;I did use some of the original graphics that were easy to get hold of using screen dumps.'.split(";"),
s=1,C=0,z=0,da=[function(a,c,p,f){r||(r=document.createElement("CANVAS"),r.width=256,r.height=1088,h=r.getContext("2d"),h.fillStyle="#ffffff",h.textBaseline="top",y=document.createElement("CANVAS"),y.width=256,y.height=1088,O=y.getContext("2d"));d.clearRect(0,0,640,512);if(0!=a){switch(a){case 1:m.position.x=40*Math.sin(c/1900);m.position.z=40*Math.cos(c/1900);m.position.y=200+30*Math.sin(c/950);m.up=new THREE.Vector3(0.4*Math.sin(c/1600+0.7),1,0.7*Math.sin(c/2100+1.1));a={x:x.position.x,y:x.position.y,
z:x.position.z};a.z+=(1-Math.cos(p*Y))/2*80;a.y-=(1-Math.cos(p*Y))/2*30;m.lookAt(a);l.setClearColor("#0b46d2",1);l.render(k,m);break;case 2:l.setClearColor("#003f79",1);l.render(N,m);break;case 3:l.setClearColor("#0b46d2",1),l.render($,m)}d.drawImage(l.domElement,0,0);p=Math.round(f);O.clearRect(0,0,256,1088);O.drawImage(r,0,0);h.clearRect(0,0,256,1088);h.drawImage(y,0,-p);s-=f;if(0>=s&&(f=ea[C],s+=39,"string"==typeof f)){0==C?(h.font="bold normal 30px sans-serif",s+=10,h.fillStyle="#ff9900"):(h.font=
"normal normal 26px sans-serif",h.fillStyle="#ffffff");f=f.substr(z);p=h.measureText(f).width;if(252<p)if(a=f.split(" "),1<a.length){c=[];for(var b=0;b<a.length;++b)if(c.push(a[b]),p=h.measureText(c.join(" ")).width,252<p){0==b?f=a[0]:(c.length-=1,f=c.join(" "));z+=f.length+1;break}}else z=0,C++;else z=0,C++;h.fillText(f,4,1024)}d.drawImage(r,0,0,256,1024,512,0,128,512);d.font="normal normal 15px sans-serif";d.textBaseline="top";d.textAlign="center";d.fillStyle="#000000";d.shadowColor="#ffffff";d.shadowOffsetX=
0;d.shadowOffsetY=0;d.shadowBlur=10;d.fillText("this part is obviously not finished yet",256,15)}}],T=[{a:0,b:2E3,c:0,d:0},{a:2E3,b:42900,c:0,d:1},{a:42900,b:53180,c:0,d:2},{a:53180,b:105840,c:0,d:3},{a:105840,b:155E3,c:0,d:4}],q=[],u=0,n=null,t=null;onLoadingDone=function(){t&&(window.clearTimeout(t),t=null);k=new THREE.Scene;m=new THREE.PerspectiveCamera(50,1,0.1,1E3);var a=document.createElement("CANVAS");l=a.getContext("webgl")||a.getContext("experimental-webgl")?new THREE.WebGLRenderer:new THREE.CanvasRenderer;
l.devicePixelRatio=1;l.setSize(512,512);l.g=!0;x=X(0,190,0);k.add(x);k.add(X(10,180,50));k.add(K(0,170,20));k.add(K(-20,160,40));k.add(K(20,180,60));k.add(v(-10,180,30));k.add(v(20,200,40));k.add(v(10,190,70));k.add(v(10,210,60));k.add(v(-10,190,80));k.add(W(4222512));N=new THREE.Scene;N.add(W(3039881));$=new THREE.Scene;Z.play()};onItemsLoader=function(a){t&&(window.clearTimeout(t),t=null);d.fillStyle="#000000";d.fillRect(0,0,640,512);d.fillStyle="#000073";d.strokeStyle="#000073";d.lineWidth=50;
d.lineCap="round";d.beginPath();d.moveTo(120,256);d.lineTo(520,256);d.stroke();a.e<a.total&&(d.strokeStyle="#000000",d.lineWidth=40,d.beginPath(),d.moveTo(120,256),d.lineTo(520,256),d.stroke(),d.strokeStyle="#000073",d.lineWidth=41,d.beginPath(),d.moveTo(120,256),d.lineTo(120+400*a.e/a.total,256),d.stroke());a.e==a.total&&(d.textAlign="center",d.textBaseline="middle",d.font="20px sans-serif",d.fillText("Click to start...",320,296),window.setTimeout(onLoadingDone,1),M.addEventListener("click",onLoadingDone,
!1))};onDemoDone=function(){window.location.href="/part-3/"};onload=function(){M=document.getElementById("demo");d=M.getContext("2d");B=!1;window.addEventListener("itemsLoader",onItemsLoader,!1);var a=document.createElement("AUDIO");a.controls=!0;a.f="auto";q.push(a);++u;var c=document.createEvent("Event");c.initEvent("itemsLoader",!0,!0);c.total=u;c.e=u-q.length;window.dispatchEvent(c);a.addEventListener("play",ca,!1);a.addEventListener("timeupdate",ba,!1);a.addEventListener("progress",D,!1);a.addEventListener("canplay",
aa,!1);var c=a.canPlayType("audio/ogg"),h=a.canPlayType("audio/mpeg");if("probably"==c||"maybe"==c&&"probably"!=h)a.src="mobyle.ogg";else if("probably"==h||"maybe"==h)a.src="mobyle.mp3";a.load();Z=a};window.onload=onload})();